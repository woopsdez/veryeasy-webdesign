"use strict";
var fs = require("fs");
var path = require("path");
var yaml = require("js-yaml");
var engine_1 = require("./engine");
exports.Engine = engine_1.default;
function fromYAMLFilePath(configPath) {
    var content = fs.readFileSync(configPath, { encoding: "utf8" });
    return fromYAML(configPath, content);
}
exports.fromYAMLFilePath = fromYAMLFilePath;
function fromYAML(configPath, yamlContent) {
    var rawConfig = yaml.load(yamlContent);
    return fromRowConfig(configPath, rawConfig);
}
exports.fromYAML = fromYAML;
function fromRowConfig(configPath, rawConfig) {
    var engine = new engine_1.default(rawConfig);
    if (rawConfig.imports) {
        var tmp = rawConfig.imports;
        var imports = typeof tmp === "string" ? [tmp] : tmp;
        imports.forEach(function (im) {
            var importedConfigPath = path.resolve(path.dirname(configPath), im);
            var newEngine = fromYAMLFilePath(importedConfigPath);
            engine.merge(newEngine);
        });
    }
    return engine;
}
exports.fromRowConfig = fromRowConfig;
//# sourceMappingURL=index.js.map